# Invoice Generator Specification

## 1. Project Overview
A client-side, mobile-friendly invoice generator built with React. The application allows users to input customer details, manage line items, calculate totals (including adjustments and delivery fees), and export the final invoice as an image. It supports multiple business profiles and specific payment methods relevant to the Myanmar market (MMK currency).

## 2. Tech Stack
- **Framework**: React 18+ (Vite)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **Linting/Formatting**: ESLint, Prettier
- **Deployment**: Cloudflare Pages (Static)
- **Key Libraries**:
  - `html-to-image`: For generating high-quality images of the invoice DOM.
  - `lucide-react`: For UI icons.
  - `clsx` / `tailwind-merge`: For conditional class management.
  - `react-hook-form` (Optional, but good for form management) or simple controlled components.

## 3. Data Models

### Business Profile
Configurable in code (e.g., `src/config/businesses.ts`).
```typescript
interface BusinessProfile {
  id: string;
  name: string;
  phone: string;
  description?: string; // e.g., "Fashion & Accessories"
  logoUrl?: string; // Optional
  themeColor?: string; // Primary color for the invoice
}
```

### Payment Method
```typescript
type PaymentType = 'COD' | 'Prepaid';

type PrepaidProvider = 'KBZPay' | 'CBPay' | 'Wave Money' | 'Mobile Banking' | 'Others';

interface PaymentDetails {
  type: PaymentType;
  provider?: PrepaidProvider; // Required if type is Prepaid
  accountName?: string; // Optional context for the business
  accountNumber?: string; // Optional context for the business
}
```

### Invoice Item
```typescript
interface InvoiceItem {
  id: string;
  description: string;
  quantity: number;
  unitPrice: number;
}
```

### Invoice State
```typescript
interface InvoiceData {
  id: string; // Auto-generated (e.g., INV-1001)
  date: Date; // Auto-generated (Today)
  businessId: string; // Selected business
  
  // Customer Info
  customerName: string;
  customerPhone: string;
  customerAddress: string;
  
  // Line Items
  items: InvoiceItem[];
  
  // Financials
  discount: number; // Adjustment (subtracted)
  deliveryFee: number; // Added
  
  // Payment
  payment: PaymentDetails;
}
```

## 4. Functional Requirements

### A. Configuration & Inputs
1.  **Business Selection**: A dropdown at the top to switch between pre-configured business profiles.
2.  **Customer Details**: Inputs for Name, Phone, Address.
3.  **Items Management**:
    - Dynamic list of items.
    - "Add Item" button.
    - Remove button per row.
    - Fields: Description, Qty, Price.
    - Auto-calculation of "Total" per row.
4.  **Financials**:
    - **Subtotal**: Sum of all item totals.
    - **Adjustment**: Numeric input for discount (default 0).
    - **Delivery Fee**: Numeric input (default 0).
    - **Grand Total**: Subtotal - Discount + Delivery.
    - **Currency**: All displayed in MMK (e.g., "39,000 Ks" or "K39,000").
5.  **Payment Options**:
    - Toggle Switch: "Cash on Delivery" vs "Prepaid".
    - If "Prepaid" is selected, show dropdown for Provider (Default: KBZPay).

### B. Auto-Generation
- **Invoice ID**: Simple incrementing number or random string (e.g., #1001). Editable if needed, but auto-generated by default.
- **Date**: Defaults to current date.

### C. Output & Export
- **Live Preview**: The invoice should be visible as it is being edited (or split view on desktop).
- **Download Image**: Button to capture the invoice container and save as `.png`.
- **Download PDF**: (Optional) Use browser print or PDF library.

## 5. UI/UX Design Plan

### Layout Strategy
- **Mobile**: Stacked layout. Form inputs first, followed by a "Preview Invoice" button that opens a modal or scrolls to the preview card.
- **Desktop**: Two-column layout.
    - **Left Panel**: Editor (Scrollable form).
    - **Right Panel**: Sticky Preview (The actual invoice rendering).

### Visual Style (Modern & Clean)
- **Typography**: Sans-serif (Inter or Roboto).
- **Colors**:
    - Primary: Deep Blue (`bg-slate-900` or `bg-blue-900`) for headers/accents.
    - Secondary: Pink/Red (`text-pink-600`) for Grand Total and important alerts (inspired by screenshot).
    - Background: White paper look for the invoice, light gray for the app background.
- **Components**:
    - **Card**: White background, shadow-sm, rounded corners.
    - **Inputs**: Tailwind forms plugin style or custom bordered inputs.

### Invoice Template Design (The "Paper" View)
1.  **Header**:
    - Left: Business Name (Large, Bold), Phone.
    - Right: "INVOICE" label, Date, Invoice #.
2.  **Bill To**:
    - Customer Name, Phone, Address.
3.  **Payment Info**:
    - "Payment Method: [Method]"
    - If Prepaid: Show Provider icon/name.
4.  **Table**:
    - Headers: Item, Qty, Price, Total.
    - Striped rows or simple border-bottom.
5.  **Footer**:
    - Right aligned summary (Subtotal, Discount, Delivery, Total).
    - Grand Total: Large font, distinct color.
    - Bottom Left: "Thank you for your business" or configurable note.

## 6. Implementation Steps

1.  **Setup**:
    - Install Tailwind CSS.
    - Install `lucide-react`, `html-to-image`, `clsx`.
2.  **Configuration**:
    - Create `businesses.ts` with mock data.
3.  **Components**:
    - `InvoiceEditor`: The form component.
    - `InvoicePreview`: The display component (pure presentation).
    - `App`: State holder.
4.  **Logic**:
    - Implement `useInvoice` hook to handle calculations and state updates.
5.  **Export**:
    - Implement `handleDownloadImage` using `html-to-image`.
6.  **Refinement**:
    - Styling polish.
    - Mobile responsiveness check.
